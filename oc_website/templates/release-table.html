{% macro table(releases, filter, takedown_request) %}
<ul class='release'>
{% for release in releases|rejectattr('is_hidden')|projectfilter(filter) %}
  <li>
    <table>

      <tr>
        <td>Date:</td>
        <td>
          <span class='date'>{{ release.date.strftime('%A, %d %b %Y %H:%M:%S') }}</span>
        </td>
      </tr>

      <tr>
        <td>Files:</td>
        <td>
          <ul class='files'>
            {% for file in release.files %}
              <li>
                {{ file.file_name }}
                {% if file.file_version > 1 %}
                  (v{{ file.file_version }})
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </td>
      </tr>

      <tr>
        <td>BTIH:</td>
        <td>{{ release.btih|default('Unknown') }}</td>
      </tr>

      <tr>
        <td>Links:</td>
        <td>
          {% if takedown_request %}
            Links removed due to takedown request sent by {{ takedown_request }}.
          {% else %}
            <ul class='links'>
              {% for link in release.links %}
                <li>
                  {%- for infix in ['magnet', 'nyaa.si', 'nyaa.net', 'anidex.info'] -%}
                    {%- if infix in link -%}
                      <a href="{{ link }}" title="{{ link }}">{#
                        #}<img src='/img/{{ infix }}.png' title='{{ infix }}'/>{#
                        #}<span>{{ infix }}</span>{#
                      #}</a>
                    {%- endif -%}
                  {%- endfor -%}
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </td>
      </tr>

    </table>

  </li>
{% endfor %}
</ul>
{% endmacro %}
